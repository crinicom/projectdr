<div class="container">
    <h1><%= project.name %></h1>
    <br>

    <H2>Sponsors</H2>
    <table>
        <% _.each(project.sponsors, function(sponsor) { %>
            <tr data-id="<%= project.id%>" data-model="project">
                <!-- <td><%=project.id%></td> -->
                <td><%=sponsor%></td>
                <<td><a href="#">Delete</a></td>
            
            </tr>
    <% }); %>
    </table>


    <h3>Description: </h3>
    <h4><%= project.description %></p>
    <h3>Scope: </h3>
    <p><%= project.scope %></p>

    <p>
        <a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
            Ver comentarios
        </a>
    </p>
    <div class="collapse" id="collapseExample">
        <div class="card card-body">
                
                <%// partial('../comment/new.ejs') %>
            
            <form action="/comment/new" method="POST">
                    <input type="hidden" value="<%=project.id%>" name="belongs_to">
                    <input type="hidden" value="/project/show/<%=project.id%>" name="comes_from">
                    <input type="submit" class="btn btn-sm btn-success" value="New comment">
                    <input type="hidden" value="<%=_csrf%>" name="_csrf">
                </form>
        </div>
    </div>


<!-- Boton de edición de los datos básicos de proyecto, lleva a update -->
    <a href="/project/edit/<%=project.id%>">Edit</a>
    <form action="/project/edit/<%=project.id%>" method="POST">
        <button type="submit" class="btn btn-primary btn-block">
            <i class="fa fa-pencil fa-2x" aria-hidden="true"></i>
            Editar
        </button>
        <input type="hidden" value="<%=_csrf%>" name="_csrf">
    </form>


    <hr>
    <H2>Objectives</H2>
    <table class="table table-sm table-hover table-bordered table-striped">
        <tr>
            <th>ID</th>
            <th>Objective</th>
            <th>Formula</th>
            <th>Goal</th>
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <% _.each(project.objectives, function(objective) { %>
            <tr data-id="<%= objective.id%>" data-model="objective">
                <td><%= objective.id%></td>
                <td><%= objective.description%></td>
                <td><%= objective.formula%></td>
                <td><%= objective.goal%></td>
                <!-- <td><a href="/project/show/<%=project.id%>">Show</a></td> -->
                <td><a href="/objective/edit/<%=objective.id%>">Edit</a></td>
                <td>
                        <form action="/objective/destroy/<%= objective.id %>" method="POST">
                            <input type="hidden" name="belongs_to_project" value="<%= objective.belongs_to_project %>" />
                            <input type="hidden" name="_method" value="delete" />
                            <input type="submit" class="btn btn-sm btn-danger" value="X" />
                            <input type="hidden" name="_csrf" value="<%= _csrf%>"/>
                        </form>
                </td>
            
            </tr>
    <% }); %>
    </table>
   

    <form action="/objective/new" method="POST">
    <input type="hidden" value="<%=project.id%>" name="belongs_to_project">
    <input type="submit" class="btn btn-sm btn-success" value="Add Objective">
    <input type="hidden" value="<%=_csrf%>" name="_csrf">
    </form>

    <hr>
    <H2>Milestones</H2>
    <table class="table table-sm table-striped table-hover">
        <tr>
            <th>ID</th>
            <th>Milestone</th>
            <th>Date</th>
            
            <th></th>
            <th></th>
            <th></th>
        </tr>
        <% _.each(project.milestones, function(milestone) { %>
            <tr data-id="<%= milestone.id%>" data-model="milestone">
                <td><%= milestone.id%></td>
                <td><%= milestone.description%></td>
                <td><%= milestone.date%></td>
                <td><a href="/milestone/edit/<%=milestone.id%>">Edit</a></td>
                <td>
                        <form action="/milestone/destroy/<%= milestone.id %>" method="POST">
                            <input type="hidden" name="belongs_to_project" value="<%= milestone.belongs_to_project %>" />
                            <input type="hidden" name="_method" value="delete" />
                            <input type="submit" class="btn btn-sm btn-danger" value="X" />
                            <input type="hidden" name="_csrf" value="<%= _csrf%>"/>
                        </form>
                </td>
            
            </tr>
    <% }); %>
    </table>
    <form action="/milestone/new" method="POST">
        <input type="hidden" value="<%=project.id%>" name="belongs_to_project">
        <input type="submit" class="btn btn-sm btn-success" value="New Milestone">
        <input type="hidden" value="<%=_csrf%>" name="_csrf">
    </form>
 
    <hr>
    
    <% if (project.status.pcharter != "finished") {%>
    <form action="/project/show/<%=project.id%>" method="POST">
        <button type="submit" class="btn btn-primary btn-block">
            <i class="fa fa-home fa-2x" aria-hidden="true"></i>
            Guardar y continuar más tarde
        </button>
        <input type="hidden" value="<%=_csrf%>" name="_csrf">
    </form> <%}%>

    <form action="/project/save_state/<%=project.id%>" method="POST">
        <% if (project.status.pcharter != "finished") {%>
        <button type="submit" class="btn btn-success btn-block">
            <i class="fa fa-lock fa-2x" aria-hidden="true"></i>    
            Guardar y finalizar edición de Project Charter
        </button>
        <input type="hidden"  name="key" value="pcharter">
        <input type="hidden"  name="state" value="finished">
        <% } else {%>
            <button type="submit" class="btn btn-success btn-block">
                <i class="fa fa-unlock fa-2x" aria-hidden="true"></i>    
                Continuar edición de Project Charter
            </button>
            <input type="hidden"  name="key" value="pcharter">
            <input type="hidden"  name="state" value="wip">
            <%}%>            
        <input type="hidden" value="<%=_csrf%>" name="_csrf">
    </form>



    <!-- <p><%=JSON.stringify(project.status)%></p>
     -->
     <br><br><br>
    <%- partial('../navbuttons.ejs') %>

</div>